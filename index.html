// קוד זה חייב להיות מועתק ישירות ל-Google Apps Script (הרחבות -> Apps Script)
// יש ללחוץ על 'פרוס' מחדש לאחר העדכון!

// פונקציה זו רצה כשיש בקשת GET (כאשר הדף נטען - אין שימוש בפועל)
function doGet(e) {
  return HtmlService.createHtmlOutput("Method not allowed. Please submit the form using POST.");
}

// פונקציה זו רצה כשיש בקשת POST (כאשר המשתמש שולח את הטופס)
function doPost(e) {
  // 1. קביעת משתנים
  const sheetName = "Sheet1"; // ודא שזה שם הגיליון שלך (בדרך כלל Sheet1)
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = ss.getSheetByName(sheetName);

  // 2. קבלת הנתונים מהטופס (נקודה e.parameter)
  const data = e.parameter;
  
  // 3. איסוף הנתונים לפי הסדר שקבענו בכותרות
  const rowData = [
    new Date(), // Timestamp אוטומטי (עמודה A1)
    data.q1_rating,
    data.q2_reason,
    data.q3_significant,
    data.q4_tools_applied,
    data.q5_suitable_for,
    data.q6_recommend,
    data.q7_improve,
    data.q8_next_topic
  ];

  // 4. הוספת שורה חדשה לגיליון
  sheet.appendRow(rowData);

  // 5. בניית תגובה למשתמש (אישור הצלחה)
  // *** התיקון: הסרת .setMimeType(HtmlService.MimeType.TEXT) המיותר והשגוי ***
  return HtmlService.createHtmlOutput('<h1>תודה רבה!</h1><p>המשוב שלך נשלח בהצלחה.</p>');
}
